
<!doctype html>
<html>
  <meta charset="utf-8" />
  <title>News Reader</title>
  <body>
    <h1>News Reader</h1>
    <input id="q" placeholder="Tìm theo tiêu đề" />
    <select id="uid">
      <option value="">-- userId --</option>
      <option>1</option><option>2</option><option>3</option><option>4</option><option>5</option>
      <option>6</option><option>7</option><option>8</option><option>9</option><option>10</option>
    </select>
    <button id="load">Tải</button>
    <p id="state"></p>
    <ul id="list"></ul>

    <script>
      const q = document.getElementById('q');
      const uid = document.getElementById('uid');
      const state = document.getElementById('state');
      const list = document.getElementById('list');

      async function fetchAll(){
        state.textContent='Đang tải...';
        try{
          const res = await fetch('https://jsonplaceholder.typicode.com/posts');
          if(!res.ok) throw new Error('Lỗi mạng');
          const data = await res.json();
          state.textContent='';
          return data;
        }catch(e){
          state.textContent='Lỗi: '+e.message; return [];
        }
      }

      function render(data){
        const kw = q.value.trim().toLowerCase();
        const u = uid.value.trim();
        const filtered = data.filter(p => (!kw || p.title.toLowerCase().includes(kw)) && (!u || String(p.userId)===u));
        list.innerHTML = filtered.map(p=>\`<li><b>\${p.id}</b> [u\${p.userId}] \${p.title}</li>\`).join('');
      }

      document.getElementById('load').onclick = async () => {
        const data = await fetchAll();
        render(data);
        q.oninput = () => render(data);
        uid.onchange = () => render(data);
      };
    </script>
  </body>
</html>
